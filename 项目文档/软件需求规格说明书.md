# 智能校园生活助手 - 软件需求规格说明书

## 1. 项目概述
智能校园生活助手是一款面向高校学生的综合性应用，提供二手交易、课程表管理、校园点餐三大核心功能，旨在提升学生的校园生活效率和便利性。

## 2. 核心功能

### 2.1 二手交易
- **商品发布**：用户可以发布二手商品，包括商品名称、描述、价格、图片、联系方式等信息
- **商品浏览**：支持按分类、价格、发布时间等条件筛选和排序商品
- **商品搜索**：支持关键词搜索商品
- **商品详情**：查看商品详细信息，包括图片、描述、价格、发布者信息等
- **商品收藏**：用户可以收藏感兴趣的商品
- **商品留言**：用户可以在商品下留言咨询
- **个人发布管理**：用户可以管理自己发布的商品，包括编辑、删除、查看状态等
- **交易消息**：显示与商品交易相关的聊天记录，支持查看未读消息，跳转到聊天详情页

### 2.2 课程表管理
- **课程添加**：用户可以手动添加课程，包括课程名称、教师、上课时间、地点、学分等信息
- **课程导入**：支持从Excel或其他格式导入课程表
- **课程查看**：按周、日、列表等多种方式查看课程表
- **课程编辑**：用户可以编辑已添加的课程信息
- **课程删除**：用户可以删除不需要的课程
- **课程提醒**：支持设置课程提醒，提前通知上课时间

### 2.3 校园点餐
- **餐厅浏览**：查看校园内的餐厅列表和详情
- **菜品浏览**：查看各餐厅的菜品列表，包括菜品名称、价格、描述、图片等
- **菜品搜索**：支持关键词搜索菜品
- **购物车管理**：添加、删除、修改购物车中的菜品数量
- **订单提交**：提交订单，选择支付方式和配送地址
- **订单管理**：查看历史订单，包括订单状态、详情、支付信息等
- **评价功能**：对已完成的订单进行评价

### 2.4 聊天模块
- **对话列表**：显示用户的所有聊天对话，支持按未读状态筛选，显示最后一条消息预览
- **聊天详情**：显示对话的完整消息记录，支持发送文本消息，支持消息时间显示，支持滚动加载历史消息

### 2.5 用户管理模块
- **用户注册**：学生注册账号，需要提供学号、密码、姓名、手机号等信息
- **用户登录**：支持账号密码登录，生成Token进行身份验证
- **个人中心**：查看和修改个人信息，包括头像、昵称、联系方式等
- **密码修改**：支持修改登录密码
- **管理员功能**：管理用户列表，管理餐厅和菜品，管理课程和考试信息

## 3. 数据库设计

### 3.1 用户表 (users)
| 字段名 | 数据类型 | 约束 | 描述 |
|--------|----------|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 用户ID |
| student_id | VARCHAR(20) | UNIQUE, NOT NULL | 学号 |
| username | VARCHAR(50) | NOT NULL | 用户名 |
| password | VARCHAR(128) | NOT NULL | 密码（加密存储） |
| name | VARCHAR(50) | NOT NULL | 真实姓名 |
| phone | VARCHAR(20) | NOT NULL | 手机号 |
| avatar | VARCHAR(255) | | 头像URL |
| created_at | DATETIME | NOT NULL | 创建时间 |
| updated_at | DATETIME | NOT NULL | 更新时间 |

### 3.2 课程表 (courses)
| 字段名 | 数据类型 | 约束 | 描述 |
|--------|----------|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 课程ID |
| user_id | INT | FOREIGN KEY (users.id) | 所属用户ID |
| name | VARCHAR(100) | NOT NULL | 课程名称 |
| teacher | VARCHAR(50) | NOT NULL | 教师姓名 |
| day_of_week | INT | NOT NULL | 星期几（1-7） |
| start_time | TIME | NOT NULL | 开始时间 |
| end_time | TIME | NOT NULL | 结束时间 |
| location | VARCHAR(100) | NOT NULL | 上课地点 |
| credit | FLOAT | NOT NULL | 学分 |
| created_at | DATETIME | NOT NULL | 创建时间 |
| updated_at | DATETIME | NOT NULL | 更新时间 |

### 3.3 商品表 (products)
| 字段名 | 数据类型 | 约束 | 描述 |
|--------|----------|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 商品ID |
| user_id | INT | FOREIGN KEY (users.id) | 发布者ID |
| name | VARCHAR(100) | NOT NULL | 商品名称 |
| description | TEXT | NOT NULL | 商品描述 |
| price | DECIMAL(10,2) | NOT NULL | 商品价格 |
| category | VARCHAR(50) | NOT NULL | 商品分类 |
| status | INT | NOT NULL | 商品状态（0：在售，1：已售出） |
| images | JSON | | 商品图片URL列表 |
| contact | VARCHAR(100) | NOT NULL | 联系方式 |
| created_at | DATETIME | NOT NULL | 创建时间 |
| updated_at | DATETIME | NOT NULL | 更新时间 |

### 3.4 商品收藏表 (product_favorites)
| 字段名 | 数据类型 | 约束 | 描述 |
|--------|----------|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 收藏ID |
| user_id | INT | FOREIGN KEY (users.id) | 用户ID |
| product_id | INT | FOREIGN KEY (products.id) | 商品ID |
| created_at | DATETIME | NOT NULL | 收藏时间 |

### 3.5 商品留言表 (product_comments)
| 字段名 | 数据类型 | 约束 | 描述 |
|--------|----------|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 留言ID |
| user_id | INT | FOREIGN KEY (users.id) | 留言用户ID |
| product_id | INT | FOREIGN KEY (products.id) | 商品ID |
| content | TEXT | NOT NULL | 留言内容 |
| created_at | DATETIME | NOT NULL | 留言时间 |

### 3.6 餐厅表 (restaurants)
| 字段名 | 数据类型 | 约束 | 描述 |
|--------|----------|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 餐厅ID |
| name | VARCHAR(100) | NOT NULL | 餐厅名称 |
| description | TEXT | | 餐厅描述 |
| location | VARCHAR(100) | NOT NULL | 餐厅位置 |
| opening_hours | VARCHAR(100) | NOT NULL | 营业时间 |
| created_at | DATETIME | NOT NULL | 创建时间 |
| updated_at | DATETIME | NOT NULL | 更新时间 |

### 3.7 菜品表 (dishes)
| 字段名 | 数据类型 | 约束 | 描述 |
|--------|----------|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 菜品ID |
| restaurant_id | INT | FOREIGN KEY (restaurants.id) | 所属餐厅ID |
| name | VARCHAR(100) | NOT NULL | 菜品名称 |
| description | TEXT | | 菜品描述 |
| price | DECIMAL(10,2) | NOT NULL | 菜品价格 |
| image | VARCHAR(255) | | 菜品图片URL |
| status | INT | NOT NULL | 菜品状态（0：在售，1：售罄） |
| created_at | DATETIME | NOT NULL | 创建时间 |
| updated_at | DATETIME | NOT NULL | 更新时间 |

### 3.8 订单表 (orders)
| 字段名 | 数据类型 | 约束 | 描述 |
|--------|----------|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 订单ID |
| user_id | INT | FOREIGN KEY (users.id) | 用户ID |
| restaurant_id | INT | FOREIGN KEY (restaurants.id) | 餐厅ID |
| total_price | DECIMAL(10,2) | NOT NULL | 订单总价 |
| status | INT | NOT NULL | 订单状态（0：待支付，1：已支付，2：已接单，3：配送中，4：已完成，5：已取消） |
| payment_method | INT | NOT NULL | 支付方式（0：微信支付，1：支付宝，2：校园卡） |
| delivery_address | VARCHAR(255) | NOT NULL | 配送地址 |
| created_at | DATETIME | NOT NULL | 创建时间 |
| updated_at | DATETIME | NOT NULL | 更新时间 |

### 3.9 订单详情表 (order_items)
| 字段名 | 数据类型 | 约束 | 描述 |
|--------|----------|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 订单详情ID |
| order_id | INT | FOREIGN KEY (orders.id) | 订单ID |
| dish_id | INT | FOREIGN KEY (dishes.id) | 菜品ID |
| quantity | INT | NOT NULL | 菜品数量 |
| price | DECIMAL(10,2) | NOT NULL | 菜品单价 |

## 4. API 接口设计

### 4.1 用户管理接口
- **注册**：POST /api/users/register
- **登录**：POST /api/users/login
- **获取用户信息**：GET /api/users/profile
- **更新用户信息**：PUT /api/users/profile
- **修改密码**：PUT /api/users/password

### 4.2 二手交易接口
- **发布商品**：POST /api/products
- **获取商品列表**：GET /api/products
- **搜索商品**：GET /api/products/search
- **获取商品详情**：GET /api/products/{id}
- **更新商品**：PUT /api/products/{id}
- **删除商品**：DELETE /api/products/{id}
- **收藏商品**：POST /api/products/{id}/favorite
- **取消收藏**：DELETE /api/products/{id}/favorite
- **获取收藏列表**：GET /api/products/favorites
- **商品留言**：POST /api/products/{id}/comments
- **获取商品留言**：GET /api/products/{id}/comments

### 4.3 课程表接口
- **添加课程**：POST /api/courses
- **获取课程列表**：GET /api/courses
- **获取课程详情**：GET /api/courses/{id}
- **更新课程**：PUT /api/courses/{id}
- **删除课程**：DELETE /api/courses/{id}
- **导入课程**：POST /api/courses/import

### 4.4 校园点餐接口
- **获取餐厅列表**：GET /api/restaurants
- **获取餐厅详情**：GET /api/restaurants/{id}
- **获取菜品列表**：GET /api/restaurants/{id}/dishes
- **搜索菜品**：GET /api/dishes/search
- **添加到购物车**：POST /api/cart
- **获取购物车**：GET /api/cart
- **更新购物车**：PUT /api/cart/{id}
- **删除购物车项**：DELETE /api/cart/{id}
- **提交订单**：POST /api/orders
- **获取订单列表**：GET /api/orders
- **获取订单详情**：GET /api/orders/{id}
- **取消订单**：PUT /api/orders/{id}/cancel
- **评价订单**：POST /api/orders/{id}/review

## 5. 技术栈
- 后端：Django + Django REST Framework
- 前端：Vue2.js + Element UI
- 数据库：SQLite（开发环境），MySQL（生产环境）
- 部署工具：Docker & Docker Compose

## 6. 非功能需求

### 6.1 性能需求
- 页面加载时间不超过2秒
- 响应时间不超过1秒
- 支持同时在线用户数不少于1000

### 6.2 安全性需求
- 所有API请求必须经过认证
- 密码必须加密存储
- 敏感信息必须加密传输
- 防止SQL注入和XSS攻击

### 6.3 可用性需求
- 系统可用性达到99.9%
- 支持7×24小时运行
- 支持数据备份和恢复

### 6.4 兼容性需求
- 支持主流浏览器（Chrome、Firefox、Safari、Edge）
- 支持响应式设计，适配不同屏幕尺寸

### 6.5 UI设计与视觉优化
- **统一设计语言**：设计符合校园风格的配色方案，使用主色调和辅助色形成统一的视觉识别系统
- **字体系统**：采用清晰易读的字体，建立标题、正文、辅助文字的字体层级
- **图标系统**：使用统一风格的图标库，确保在不同场景下的一致性
- **响应式设计**：确保在手机、平板、桌面设备上都有良好的显示效果
- **弹性布局**：使用Element UI的响应式栅格系统，实现灵活的页面布局
- **自适应组件**：根据屏幕尺寸自动调整组件大小和排列方式
- **精致的组件设计**：为商品、餐厅、课程等内容添加卡片式设计，包含阴影、圆角和悬停效果
- **按钮设计**：统一按钮样式，区分主要操作和次要操作
- **表单设计**：优化表单布局，添加清晰的标签和提示信息
- **深色模式支持**：允许用户在浅色和深色模式之间切换

### 6.6 交互体验提升
- **流畅的动画效果**：添加页面切换时的过渡动画，按钮、卡片、菜单等组件的悬停和点击效果
- **智能交互反馈**：实时表单验证，所有用户操作都提供清晰的反馈提示
- **状态提示**：加载、成功、失败等状态的明确提示
- **优化的导航体验**：清晰的导航结构，面包屑导航，常用功能的快捷入口
- **无障碍设计**：键盘导航支持，屏幕阅读器支持，高对比度模式

## 7. 功能增强与完善

### 7.1 个人中心优化
- **头像上传**：支持用户上传和修改头像
- **个人信息管理**：完善的个人资料编辑功能
- **数据统计**：显示用户的消费记录、发布商品数量等统计信息

### 7.2 二手市场增强
- **商品分类**：更详细的商品分类体系
- **高级搜索**：支持多条件组合搜索
- **聊天功能**：买卖双方在线聊天功能
- **交易评价**：交易完成后双方互评

### 7.3 课程表增强
- **导出功能**：支持将课程表导出为Excel、ICS等格式
- **课程共享**：支持课程表的导入导出和共享
- **教室查询**：查询教室的使用情况

### 7.4 校园点餐增强
- **菜品分类筛选**：按菜品类型、价格等筛选
- **购物车优化**：支持批量操作、清空、修改数量
- **订单跟踪**：实时显示订单状态和配送进度
- **优惠活动**：支持优惠券、满减等促销活动

## 8. 技术优化与代码质量

### 8.1 性能优化
- **前端性能**：
  - 路由懒加载，减少初始加载时间
  - 图片懒加载，优化加载性能
  - 组件缓存，减少重复渲染
  - 减少HTTP请求，合并API请求
- **后端性能**：
  - 数据库索引优化
  - API响应缓存
  - 异步任务处理

### 8.2 代码质量
- **代码规范**：严格遵循ESLint和Prettier规范
- **组件化开发**：提高代码复用性和可维护性
- **清晰的注释**：关键代码添加详细注释
- **文档完善**：完善的API文档和开发文档

### 8.3 状态管理
- **Vuex状态管理**：使用Vuex管理全局状态，如用户信息、购物车、通知等
- **持久化存储**：关键数据持久化到localStorage或sessionStorage

### 8.4 测试与质量保障
- **单元测试**：对关键组件和函数进行单元测试
- **集成测试**：测试组件间的交互
- **端到端测试**：模拟用户操作流程测试

## 9. 加分项功能

### 9.1 PWA支持
- **离线使用**：支持离线访问已加载的页面
- **添加到桌面**：支持将应用添加到手机桌面
- **推送通知**：支持消息推送功能

### 9.2 国际化支持
- **多语言切换**：支持中英文切换
- **地区适配**：根据地区自动调整格式

### 9.3 第三方集成
- **微信登录**：支持微信扫码登录
- **地图集成**：显示餐厅、教室位置
- **支付集成**：支持微信支付、支付宝等多种支付方式

### 9.4 数据分析
- **用户行为分析**：统计用户使用习惯和偏好
- **数据可视化**：使用图表展示统计数据
- **智能推荐**：基于用户行为推荐商品、课程等

### 9.5 安全性增强
- **HTTPS支持**：全站HTTPS加密
- **安全认证**：加强身份验证和授权机制
- **数据加密**：敏感数据加密存储
- **防SQL注入**：防止SQL注入攻击
- **XSS防护**：防止跨站脚本攻击

## 10. 验收标准

### 10.1 功能验收
- 所有功能需求必须实现
- 功能必须符合需求描述
- 功能必须能够正常运行

### 10.2 性能验收
- 页面加载时间不超过2秒
- 响应时间不超过1秒
- 支持同时在线用户数不少于1000

### 10.3 安全性验收
- 通过安全测试，无明显安全漏洞
- 密码加密存储
- 敏感信息加密传输

### 10.4 可用性验收
- 系统可用性达到99.9%
- 支持7×24小时运行
- 支持数据备份和恢复

### 10.5 UI/UX验收
- 界面设计符合需求文档中的设计原则
- 交互体验流畅，反馈及时
- 支持响应式设计，适配不同设备

## 11. 风险评估

### 11.1 技术风险
- **实时聊天功能**：可能面临性能和扩展性挑战
- **数据库并发**：高并发情况下可能出现数据库性能问题
- **第三方集成**：依赖第三方服务可能带来稳定性风险

### 11.2 运营风险
- **用户活跃度**：需要持续运营才能保持用户活跃度
- **内容管理**：二手交易内容需要审核机制
- **支付安全**：需要确保支付过程的安全性

### 11.3 安全风险
- **数据泄露**：用户敏感数据需要严格保护
- **账户安全**：需要防止账户被盗用
- **系统攻击**：需要防范各种网络攻击

## 12. 附录

### 12.1 术语定义
| 术语 | 解释 |
|------|------|
| 二手交易 | 学生之间进行物品买卖的平台 |
| 课程表 | 显示学生课程安排的功能 |
| 校园点餐 | 学生在线点餐和查看订单的功能 |
| 聊天 | 学生之间进行即时通讯的功能 |
| JWT | JSON Web Token，用于用户认证 |
| Vue | 前端框架 |
| Django | 后端框架 |
| PWA | Progressive Web App，渐进式Web应用 |
| XSS | Cross-Site Scripting，跨站脚本攻击 |

### 12.2 参考文档
- Vue官方文档
- Django官方文档
- Django REST Framework官方文档
- Element UI官方文档

### 12.3 项目计划
- 需求分析：1周
- 设计阶段：2周
- 开发阶段：6周
- 测试阶段：2周
- 部署上线：1周

